{
  "hash": "d764f991edcce9317af01e220d61eb26",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Study: Many Archived Packages Return to CRAN\"\nexecute:\n  freeze: auto\n---\n\n\n\n\n\nCRAN packages are archived all the time, but a large portion of them\neventually gets fixed and return to CRAN.  Using public data available\nfrom different resources[^1] on CRAN, we have found that 36% of the\narchived packages get unarchived at some point [@revilla_2022]. The\nmedian time for these packages to return to CRAN is ~33 days.\n\n[^1]: Data sources used are `tools:::CRAN_current_db()`,\n`tools:::CRAN_archive_db()`, and [PACKAGES.in]. The first holds a data\nframe of packages currently on CRAN, which information on the package\nname, the package version, and the publishing timestamp.  The second\nholds a list of data frames, each comprising the same package\ninformation for all versions ever published on CRAN, except the\ncurrently available version.  The third, holds information on events\nfor packages that have ever been archived, removed, orphaned, etc.\n\n[PACKAGES.in]: https://cran.r-project.org/src/contrib/PACKAGES.in\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## Data quality checks\n\nTo make sure our assumptions about the raw input data is valid, we\nwill run some initial quality checks based on the data that are\navailable as of 2025-05-13.\n\n::: {.cell}\n\n:::\n\nA package should never unarchived more times than it is\narchive. However, there are currently 97\npackages unarchived more times than archived. There could be several\nreasons for this:\n\n - one of the previous issues with the package lead to its removal.\n - the term used for annotating an event was different ('orphaned'\n   instead of 'archived').\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|First action | Packages|\n|:------------|--------:|\n|orphaned     |       86|\n|removed      |       53|\n|archived     |       21|\n|renamed      |        1|\n\n\n\n**Figure: First recorded action taken of a package.** Looking by date most packages' first action recorded is being added to CRAN. For some it isn't.\n:::\n:::\n\nWe also check what the first recorded event packages have.  If the\nfirst action recorded for a package is not that it is 'accepted', this\ncan indicate some problems on the data that could lead to problems on\nthe conclusions.\n\nA special mention of the 'removed' action: This action is usually\nreserved to copyright issues and it is normal that it is the first\naction in record for a package as previous records are removed too\nfrom CRAN (package source code).\n\nBy contrast, we should not expected lack of records on CRAN of\n'accepted' packages. Based on the current data, this is the case for\n118 packages. This could indicated that packages\nhave been 'renamed' or 'removed'.  Another explanations could be that\nthere was a dialogue between the package maintainers and the CRAN Team\nthat lead to the package being 'unarchived' without new 'accepted'\npackages.  It could be because of a missing entry in the CRAN\ndata.\n\n::: {.cell tbl-cap='**Table: Events per package in the same date.** Most packages have just one action per day. Unarchiving usually requires a new package\\'s version accepted the same day.'}\n::: {.cell-output-display}\n\n\n| Multiple actions | Events | % events |\n|:----------------:|:------:|:--------:|\n|        1         | 64963  |   86%    |\n|        2         |  9896  |   13%    |\n|        3         |  336   |    0%    |\n\n\n:::\n:::\n\nIn total there are 457 'unarchived' events that do not have the corresponding 'accepted' package included event (on the same date).  Currently, this is the case for 442 packages out of 9838 (4%).\n\nOn the contrary, there are some events that are not expected to happen\non the same day:\n\n::: {.cell tbl-cap='**Table: Actions that happend on the same date in a given package.** Mostly a new acceptance lead to a package being unarchived. In some occasions other actions.'}\n::: {.cell-output-display}\n\n\n|         Multiple actions         | Events |    %    |\n|:--------------------------------:|:------:|:-------:|\n|      accepted & unarchived       |  4740  | 93.917% |\n|       accepted & orphaned        |  118   | 2.338%  |\n| accepted & archived & unarchived |  111   | 2.199%  |\n|       accepted & archived        |   66   | 1.308%  |\n|      accepted & unorphaned       |   5    | 0.099%  |\n|      archived & unarchived       |   5    | 0.099%  |\n| accepted & orphaned & unarchived |   1    | 0.020%  |\n|      orphaned & unorphaned       |   1    | 0.020%  |\n\n\n:::\n:::\n\n\nThose with three different actions imply that there has been multiple\nrevisions from the CRAN Team on the same day.\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\nIn total there are 642 different packages\nidentified with problematic records/processing from 9838.  Out of these, 117 were found to have two or more different issues.  Depending on which issue, they might be corrected to the best of our abilities, or simply be discarded depending on the issue and question we are trying to answer.\n\n\n## Analysis\n\nNow that we have looked into the data quality, we can start trying to\nanswer some questions:\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n### Summary of how long it takes packages to be unarchived\n\n::: {.cell tbl-cap='**Table: Summary statistics of time to get back to CRAN after being archived.** Median time is 33 days.'}\n::: {.cell-output-display}\n\n\n| Times archived | Packages |  Min.  | 1st Qu. | Median  |   Mean   | 3rd Qu.  |   Max.    |\n|:--------------:|:--------:|:------:|:-------:|:-------:|:--------:|:--------:|:---------:|\n|       1        |   3611   | 1 days | 9 days  | 34 days | 138 days | 131 days | 3960 days |\n|       2        |   736    | 1 days | 8 days  | 30 days | 107 days | 102 days | 1949 days |\n|       3        |   205    | 1 days | 8 days  | 27 days | 94 days  | 94 days  | 882 days  |\n|       4        |    65    | 1 days | 5 days  | 23 days | 71 days  | 71 days  | 652 days  |\n|       5        |    17    | 1 days | 3 days  | 13 days | 30 days  | 58 days  |  93 days  |\n|       6        |    6     | 3 days | 20 days | 45 days | 194 days | 206 days | 797 days  |\n|       7        |    2     | 2 days | 20 days | 38 days | 38 days  | 56 days  |  74 days  |\n\n\n:::\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Summary statistics of time to get back to CRAN after being archived.** Graphical representation of the previous table.](cran-archiving-stats_files/figure-html/plot-times-1.png){width=672}\n:::\n:::\n\n\n### Return time for packages archived only once in their lifetime\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Empirical distribution of the time it takes packages to get unarchived as a function of number of days since being archived on CRAN for the first time.**](cran-archiving-stats_files/figure-html/plot-ecdf-1.png){width=672}\n:::\n:::\n\n\n\n### Return time for packages archived\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Empirical distribution of the time it takes packages to get unarchived as a function of number of days since being archived on CRAN.**](cran-archiving-stats_files/figure-html/plot-ecdf-all-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages archived and date since the previous release.** The color indicates if a given package was archived multiple times; the more times it has been archived the lighter the point is.](cran-archiving-stats_files/figure-html/return-time3-1.png){width=672}\n:::\n:::\n\n\n### Cumulative number of archived packages over the years\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages actions done by the CRAN Team over time**. The CRAN Team may take different actions for packages currently on e.g. archived (solid red), orphaned (dotted yellow), removed (dashed green), renamed (dashed blue), and unarchived (dotted purple). Presented is the cumulative number of such events over time on the linear (left) and the logarithmic (right) scale.](cran-archiving-stats_files/figure-html/plot-cumulative-1.png){width=672}\n:::\n:::\n\n\n### Days to return versus date when archived\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages being archived and returning to CRAN.** Each data point represents when a CRAN package was archived (horizontal axis) and when it was unarchived (vertical axis). If more than one package was archive and unarchived on the same dates, the corresponding data point is presented as a larger disk. The gray dashed line is the event horizon.](cran-archiving-stats_files/figure-html/plot-events-1.png){width=672}\n:::\n:::\n\n\n### Distribution of number of days for packages to return to CRAN\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Histogram of how long packages remain archived on CRAN**. Each bar represents a week. Most packages return to CRAN within a month.](cran-archiving-stats_files/figure-html/plot-distribution-1.png){width=672}\n:::\n:::\n\n### Packages archived over all\n\nThere have been at least 9656 packages archived from CRAN. \nFrom the total of 24429 in its whole history. \nWhich results in  40% of all packages ever in CRAN got at one point archived.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages are archived multiple times**. Packages archived are sometimes back on CRAN and archived again.](cran-archiving-stats_files/figure-html/packages-archived-1.png){width=672}\n:::\n:::\n\nMost packages are not archived, but if they are mostly archived once. \nThis is probably because 50% of those archived never get back to CRAN.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Most packages are not back to CRAN after being archived**. Packages that got archived sometimes go back on CRAN.](cran-archiving-stats_files/figure-html/packages-archived-unarchived-1.png){width=672}\n:::\n:::\n\nApproximately 39% packages gets back on CRAN.\n\n\n### Packages resubmission \n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Resubmission process by date of being archived.** Events in black are those we cannot say if they were not re-submitted or rejected. The dashed gray lines are the dates of R minor releases.](cran-archiving-stats_files/figure-html/archived-type-1.png){width=672}\n:::\n:::\n\nNotice how there are some packages that submitted a new version to CRAN after 2020-09-12, but where archived long before (those that are in red before that date).\nThose maintainers might need help to get their packages back on CRAN.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Submissions are slightly faster for those that are accepted.** Percentage of packages that are submitted before a given time.](cran-archiving-stats_files/figure-html/archived2resubmit-1.png){width=672}\n:::\n:::\n\n\n\n# Slowdown due to resubmission\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|   Back to CRAN?   | Events |   %   | % submitted |\n|:-----------------:|:------:|:-----:|:-----------:|\n|     Accepted      |  2921  | 50.6% |     95%     |\n| Never resubmitted |  2702  | 46.8% |     NA      |\n|   Not accepted    |  153   | 2.6%  |     5%      |\n\n\n:::\n:::\n\nBased on a the latest data available, which is 60% of the archived packages, slightly more than half of the packages try to get back to CRAN.\nThose that try almost all of them eventually get back to CRAN.\n\nBut how fast is the process of being back on CRAN?\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Resubmission delay: % spend in review after submitting a new version till it is accepted.** Only includes packages that were accepted one day later than submitted (to avoid dividing by 0)](cran-archiving-stats_files/figure-html/speed-resubmission-1.png){width=672}\n:::\n:::\n\nMost packages that get back to CRAN are accepted soon after submitting the new version fixing the problems of being archived.\nBut some (~ 20%) spend most of the time trying to pass checks to comply with CRAN policies: maybe trying to fix issues detected on submission or waiting for CRAN maintainers feedback.\n\n### Packages not addressed in time\n\n::: {.cell}\n\n:::\n\n\nPackages are archived because they are not addressed/corrected in time.\nIf we look in more detail on this packages we see there are 5398 packages that failed to correct in time. \nMost of them where archived once but some of them (1145) were archived multiple times.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages archived because problems were not fixed on time are mostly back.**. Packages that got archived because maintainers couldn't fix the packages on time got back on time](cran-archiving-stats_files/figure-html/failed-check-archived-1.png){width=672}\n:::\n:::\n\n\n::: {#tbl-not-fixed .cell tbl-cap='**Table: Tally of reasons of packages not fixed**. Many packages are not fixed and the maintainer address.'}\n::: {.cell-output-display}\n\n\n| Not fixed | Dependencies | Maintainer address | Policy violation | Packages |\n|:---------:|:------------:|:------------------:|:----------------:|:--------:|\n|   TRUE    |    FALSE     |       FALSE        |      FALSE       |   5952   |\n|   FALSE   |    FALSE     |       FALSE        |      FALSE       |   1514   |\n|   FALSE   |     TRUE     |       FALSE        |      FALSE       |   1371   |\n|   FALSE   |    FALSE     |       FALSE        |       TRUE       |   686    |\n|   FALSE   |    FALSE     |        TRUE        |      FALSE       |   227    |\n|   TRUE    |     TRUE     |       FALSE        |      FALSE       |   186    |\n|   FALSE   |     TRUE     |       FALSE        |       TRUE       |    42    |\n|   TRUE    |    FALSE     |        TRUE        |      FALSE       |    18    |\n|   TRUE    |    FALSE     |       FALSE        |       TRUE       |    13    |\n|   FALSE   |    FALSE     |        TRUE        |       TRUE       |    3     |\n|   FALSE   |     TRUE     |        TRUE        |      FALSE       |    2     |\n\n\n:::\n:::\n\nThe first cause of archiving is packages not fixed, the second cause is not clear\nas it seems a mix o circumstances and difficulties parsing the cause. \nThe third cause of archiving is due to a package it depends being archived and the fourth because the package didn't comply with CRAN's policy.\nThe fifth most common reason is that the email address of the maintainer fails to receive emails.\n\n#### Linked to R-releases?\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: More packages are archived the closer the release date is.** On the left side packages archived long before the next R minor release, on the right side packages archived closer to R release minor colored by their submission process after being archived.](cran-archiving-stats_files/figure-html/r-versions-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages are usually archived weeks after a release.** On the left side packages archived after a R minor release, on the right side packages archived long after a R release minor colored by their submission process after being archived.](cran-archiving-stats_files/figure-html/r-versions2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages tend to be archived right before a release or after it but not in the middle of releases.** On the left side packages archived after a R minor release, on the right side packages archived before the next a R release minor colored by their submission process after being archived.](cran-archiving-stats_files/figure-html/r-versions3-1.png){width=672}\n:::\n:::\n\nOnly in 2022 and 2023 there has been a clear trend for packages that are archived closer to next release and after release respectively:\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Trend by year of packcages being archived.** The closer to the left the closer they are after a release, the more to the right the closer they are archived before a R-release.](cran-archiving-stats_files/figure-html/r- version4-1.png){width=672}\n:::\n:::\n\n\n#### Age of archival\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Time since being accepted to being archived.** Most packages are archived soon after being accepted. There are packages that keep the initial version for several years without problems.](cran-archiving-stats_files/figure-html/aged-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Time since being accepted for the first time to being archived.** Most packages are archived soon after being accepted for the first time.](cran-archiving-stats_files/figure-html/aged2-1.png){width=672}\n:::\n:::\n\nPackages are often archived after being first accepted. \nThere is a peak of archived packages 2 weeks after the acceptance, but there are also packages archived before the usually 2 weeks period to fix issues.\nPassing the first month seems critical for packages as the rates later on seems more stable. \n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Time since last version till the package is archived.** Most packages are archived shortly after a release, which might indicate that problems are only found after being accepted via additional checks not available to maintainers.](cran-archiving-stats_files/figure-html/aged-public-1.png){width=672}\n:::\n:::\n\nPackages that were already on CRAN are archived sooner after a new release. \nThis matches the trend on first time accepted packages.\nIf anything the trend to archive packages soon after being accepted is higher. \n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Age of packages being archived.** Older packages are increasingly being archived but not at the same rate time passes.](cran-archiving-stats_files/figure-html/aged-public1-1.png){width=672}\n:::\n:::\n\nAge of packages archived is increasing.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Time since previous releases of packages being archived.** Almost a constant rate except on a a specific moments.](cran-archiving-stats_files/figure-html/aged-public2-1.png){width=672}\n:::\n:::\n\nPackages archived keep updating to an almost fixed rate. \n\n### Archived because depends on other packages\n\nWhen a package is going to be archived CRAN sends an email to the maintainer which package in trouble and all the packages maintainers that depend on it. \nThis often results in people stepping up and fixing the package.\nWhen this doesn't happen, packages will be archived together with their dependency.\n\n::: {.cell tbl-cap='**Table: Dependencies impact**. Most packages archived result in another package archived.'}\n::: {.cell-output-display}\n\n\n| Affected packages | Times |\n|:-----------------:|:-----:|\n|         1         |  573  |\n|         2         |  170  |\n|         3         |  93   |\n|         4         |  52   |\n|         5         |  34   |\n|         6         |  21   |\n|         7         |  16   |\n|         8         |   8   |\n|         9         |   8   |\n|        10         |   5   |\n|        11         |   3   |\n|        12         |   6   |\n|        14         |   2   |\n|        17         |   6   |\n|        22         |   7   |\n\n\n:::\n:::\n\n\nThe packages that affected more packages lead to 18 packages archived.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Archived packages due to a dependency often come back.** In absolute numbers (left) and in percentage (right). Many packages that are archived result in another package being archived, which are usually back to CRAN.](cran-archiving-stats_files/figure-html/depending-on2-1.png){width=672}\n:::\n:::\n\nThose packages that were archived were mostly back on CRAN.\n\n### Maintainers\n\n#### Failing email\n\nSometimes the problem is with maintainer's email.\n\n::: {.cell}\n::: {.cell-output-display}\n![**Figure: Packages with not responsive maintainer address are archived later after the last version.** The line indicates the approximation of these two variables.](cran-archiving-stats_files/figure-html/maintainers-emails-1.png){width=672}\n:::\n:::\n\nAs the time increase between being archived and the failing email, this seems to indicate that maintainers are now more careful with the email given.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}