{
  "hash": "df4303eaf561ee2dba207d7cfd399231",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Study: Many Archived Packages Return to CRAN\"\nexecute:\n  freeze: auto\n---\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCRAN packages are archived all the time, but a large portion of them\neventually gets fixed and return to CRAN.  Using public data available\nfrom different resources[^1] on CRAN, we have found that 36% of the\narchived packages get unarchived at some point [@revilla_2022]. The\nmedian time for these packages to return to CRAN is ~33 days.\n\n[^1]: Data sources used are `tools:::CRAN_current_db()`,\n`tools:::CRAN_archive_db()`, and [PACKAGES.in].\n\n[PACKAGES.in]: https://cran.r-project.org/src/contrib/PACKAGES.in\n\n## Data quality checks\n\nFirst of all we will make some checks on the data to be sure of the conclusions and inferences based on it.\n\n\n::: {.cell}\n\n:::\n\n\nThere are 96 packages unarchived more times than archived.\nThis could be because several reasons:\n\n - one of the previous issues with package lead to its removal. \n - the term used for annotating an event was different (Orphaned instead of archived).\n\nWe also check what is the first record that CRAN has of a package. \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|First action | Packages|\n|:------------|--------:|\n|orphaned     |       85|\n|removed      |       68|\n|archived     |       21|\n|renamed      |        1|\n\n\n\n**First recorded action taken of a package.** Looking by date most packages' first action recorded is being added to CRAN. For some it isn't.\n:::\n:::\n\n\nIf the first action recorded for a package is not its inclusion this can indicate some problems on the data that could lead to problems on the conclusions.\n\nA special mention to the removed action: This action is usually reserved to copyright issues and it is normal that it is the first action in record for a package as previous records are removed too from CRAN (package source code). \n\nBy contrast, it isn't expected that there is no record on CRAN of accepted packages, this could mean that a package was renamed or that it was removed. \nThis happens for 134 packages.\n\nOther possible explanations for this: Maintainers of the packages might have an exchange with the CRAN volunteers that lead to unarchiving the package without new accepted packages. \nIt could also show a missing entry in the CRAN archives.\n\n\n::: {.cell tbl-cap='**Events per package in the same date.** Most packages have just one action per day. Unarchiving usually requires a new package\\'s version accepted the same day.'}\n::: {.cell-output-display}\n\n\n| Multiple actions | Events | % events |\n|:----------------:|:------:|:--------:|\n|        1         | 59631  |   87%    |\n|        2         |  8971  |   13%    |\n|        3         |  331   |    0%    |\n\n\n:::\n:::\n\n\nIn total there are 419 unarchived events that doesn't have the corresponding accepted package included event (on the same date). \nThis affects 407 packages out of 9242 (4%).\n\nOn the contrary there are some events that are not expected to happen on the same day:\n\n\n::: {.cell tbl-cap='**Actions that happend on the same date in a given package.** Mostly a new acceptance lead to a package being unarchived. In some ocasions other actions.'}\n::: {.cell-output-display}\n\n\n|         Multiple actions         | Events |    %    |\n|:--------------------------------:|:------:|:-------:|\n|      accepted & unarchived       |  4279  | 93.367% |\n|       accepted & orphaned        |  121   | 2.640%  |\n| accepted & archived & unarchived |  109   | 2.378%  |\n|       accepted & archived        |   63   | 1.375%  |\n|      archived & unarchived       |   7    | 0.153%  |\n|        accepted & removed        |   3    | 0.065%  |\n| accepted & orphaned & unarchived |   1    | 0.022%  |\n\n\n:::\n:::\n\n\n\nThose with 3 different actions imply multiple revisions from the CRAN team the same day. \n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nIn total there are 616 different packages identified with problematic records/processing from 0. \nSome of them were found that had at two or more different issues 118.\nDepending on which issue they might be corrected to the best of our abilities or simply discarded depending on the issue and question we are trying to answer. \n\n## Analysis\n\nNow that we have looked into the data quality we can start trying to answer some questions:\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### Summary of how long it takes packages to be unarchived\n\n\n::: {.cell tbl-cap='**Table with summary statistics of time to get back to CRAN after being archived.** Median time below 33 days.'}\n::: {.cell-output-display}\n\n\n| Times archived | Packages |  Min.  | 1st Qu. | Median  |   Mean   | 3rd Qu.  |   Max.    |\n|:--------------:|:--------:|:------:|:-------:|:-------:|:--------:|:--------:|:---------:|\n|       1        |   3319   | 1 days | 9 days  | 33 days | 126 days | 125 days | 3292 days |\n|       2        |   654    | 1 days | 8 days  | 27 days | 93 days  | 90 days  | 1949 days |\n|       3        |   169    | 1 days | 7 days  | 25 days | 89 days  | 77 days  | 882 days  |\n|       4        |    55    | 1 days | 4 days  | 17 days | 69 days  | 66 days  | 652 days  |\n|       5        |    16    | 1 days | 3 days  | 13 days | 28 days  | 48 days  |  93 days  |\n|       6        |    5     | 3 days | 17 days | 27 days | 73 days  | 63 days  | 254 days  |\n|       7        |    1     | 2 days | 2 days  | 2 days  |  2 days  |  2 days  |  2 days   |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**summary statistics of time to get back to CRAN after being archived.** Same as the previous table but in graphical format.](cran-archiving-stats_files/figure-html/plot-times-1.png){width=672}\n:::\n:::\n\n\n\n### Return time for packages archived only once in their lifetime\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Empirical distribution of the time it takes packages to get unarchived as a function of number of days since being archived on CRAN for the first time.](cran-archiving-stats_files/figure-html/plot-ecdf-1.png){width=672}\n:::\n:::\n\n\n### Return time for packages archived\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Empirical distribution of the time it takes packages to get unarchived as a function of number of days since being archived on CRAN.](cran-archiving-stats_files/figure-html/plot-ecdf-all-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages archived and date since the previous release.** The color indicates if a given package was archived multiple times: the more times it has been archived the lighter the point is.](cran-archiving-stats_files/figure-html/return-time3-1.png){width=672}\n:::\n:::\n\n\n\n### Cumulative number of archived packages over the years\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages actions done by the CRAN Team over time**. The CRAN Team may take different actions for packages currently on e.g. archived (solid red), orphaned (dotted yellow), removed (dashed green), renamed (dashed blue), and unarchived (dotted purple). Presented is the cumulative number of such events over time on the linear (left) and the logarithmic (right) scale.](cran-archiving-stats_files/figure-html/plot-cumulative-1.png){width=672}\n:::\n:::\n\n\n\n### Days to return versus date when archived\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages being archived and returning to CRAN.** Each data point represents when a CRAN package was archived (horizontal axis) and when it was unarchived (vertical axis). If more than one package was archive and unarchived on the same dates, the corresponding data point is presented as a larger disk. The gray dashed line is the event horizon.](cran-archiving-stats_files/figure-html/plot-events-1.png){width=672}\n:::\n:::\n\n\n\n### Distribution of number of days for packages to return to CRAN\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Histogram of how long packages remain archived on CRAN**. Each bar represents a week. Most packages return to CRAN within a month.](cran-archiving-stats_files/figure-html/plot-distribution-1.png){width=672}\n:::\n:::\n\n\n### Packages archived over all\n\nThere have been at least 9047 packages archived from CRAN. \nFrom the total of 22895 in its whole history. \nWhich results in  40% of all packages ever in CRAN got at one point archived.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages are archived multiple times**. Packages archived are sometimes back on CRAN and archived again.](cran-archiving-stats_files/figure-html/packages-archived-1.png){width=672}\n:::\n:::\n\n\nMost packages are not archived, but if they are mostly archived once. \nThis is probably because 50% of those archived never get back to CRAN.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Most packages are not back to CRAN after being archived**. Packages that got archived sometimes go back on CRAN.](cran-archiving-stats_files/figure-html/packages-archived-unarchived-1.png){width=672}\n:::\n:::\n\n\nApproximately 38% packages gets back on CRAN.\n\n\n### Packages resubmission \n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Resubmission process by date of being archived.** Events in black are those we cannot say if they were not re-submitted or rejected.](cran-archiving-stats_files/figure-html/archived-type-1.png){width=672}\n:::\n:::\n\n\nNotice how there are some packages that submitted a new version to CRAN after 2020-09-12, but where archived long before (those that are in red before that date).\nThose maintainers might need help to get their packages back on CRAN.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Submissions are slightly faster for those that are accepted.** Percentage of packages that are submitted before a given time.](cran-archiving-stats_files/figure-html/archived2resubmit-1.png){width=672}\n:::\n:::\n\n\n\n\n# Slowdown due to resubmission\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|   Back to CRAN?   | Events |   %   | % submitted |\n|:-----------------:|:------:|:-----:|:-----------:|\n| Never resubmitted |  2555  | 49.2% |     NA      |\n|     Accepted      |  2500  | 48.1% |     95%     |\n|      Not fit      |  143   | 2.8%  |     5%      |\n\n\n:::\n:::\n\n\nBased on a the latest data available, which is NA of the archived packages, slightly more than half of the packages try to get back to CRAN.\nThose that try almost all of them eventually get back to CRAN.\n\nBut how fast is the process of being back on CRAN?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Resubmission delay: % spend in review after submitting a new version till it is accepted.** Only includes packages that were accepted one day later than submitted (to avoid dividing by 0)](cran-archiving-stats_files/figure-html/speed-resubmission-1.png){width=672}\n:::\n:::\n\n\nMost packages that get back to CRAN are accepted soon after submitting the new version fixing the problems of being archived.\nBut some (~ 21%) spend most of the time trying to pass checks to comply with CRAN policies: maybe trying to fix issues detected on submission or waiting for CRAN maintainers feedback.\n\n### Packages not addressed in time\n\n\n::: {.cell}\n\n:::\n\n\n\nPackages are archived because they are not addressed/corrected in time.\nIf we look in more detail on this packages we see there are 5127 packages that failed to correct in time. \nMost of them where archived once but some of them (986) were archived multiple times.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages archived because problems were not fixed on time are mostly back.**. Packages that got archived because maintainers couldn't fix the packages on time got back on time](cran-archiving-stats_files/figure-html/failed-check-archived-1.png){width=672}\n:::\n:::\n\n::: {#tbl-not-fixed .cell tbl-cap='**Tally of reasons of packages not fixed**. Many packages are not fixed and the maintainer address.'}\n::: {.cell-output-display}\n\n\n| Not fixed | Dependencies | Maintainer address | Policy violation | Packages |\n|:---------:|:------------:|:------------------:|:----------------:|:--------:|\n|   TRUE    |    FALSE     |       FALSE        |      FALSE       |   5774   |\n|   FALSE   |    FALSE     |       FALSE        |      FALSE       |   1445   |\n|   FALSE   |     TRUE     |       FALSE        |      FALSE       |   1256   |\n|   FALSE   |    FALSE     |       FALSE        |       TRUE       |   639    |\n|   FALSE   |    FALSE     |        TRUE        |      FALSE       |   228    |\n|   TRUE    |    FALSE     |        TRUE        |      FALSE       |    18    |\n|   TRUE    |     TRUE     |       FALSE        |      FALSE       |    6     |\n|   FALSE   |     TRUE     |       FALSE        |       TRUE       |    4     |\n|   TRUE    |    FALSE     |       FALSE        |       TRUE       |    4     |\n|   FALSE   |     TRUE     |        TRUE        |      FALSE       |    1     |\n\n\n:::\n:::\n\n\nThe first cause of archiving is packages not fixed, the second cause is not clear\nas it seems a mix o circumstances and difficulties parsing the cause. \nThe third cause of archiving is due to a package it depends being archived and the fourth because the package didn't comply with CRAN's policy.\nThe fifth most common reason is that the email address of the maintainer fails to receive emails.\n\n#### Linked to R-releases?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**More packages are archived the closer the release date is.**](cran-archiving-stats_files/figure-html/r-versions-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages are usually archived weeks after a release.**](cran-archiving-stats_files/figure-html/r-versions2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages tend to be archived right before a release or after it but not in the middle of releases.**](cran-archiving-stats_files/figure-html/r-versions3-1.png){width=672}\n:::\n:::\n\n\nOnly in 2022 and 2023 there has been a clear trend for packages that are archived closer to next release and after release respectively:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Trend by year of packcages being archived.** The closer to the left the closer they are after a release, the more to the right the closer they are archived before a R-release.](cran-archiving-stats_files/figure-html/r- version4-1.png){width=672}\n:::\n:::\n\n\n\n#### Age of archival\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Time since being accepted to being archived.** Most packages are archived soon after being accepted](cran-archiving-stats_files/figure-html/aged-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![**Time since being accepted to being archived.** Most packages are archived soon after being accepted](cran-archiving-stats_files/figure-html/aged-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Time since last version till the package is archived.** Most packages are archived shortly after a release, which might indicate that problems are only found after being accepted via additional checks not available to maintainers.](cran-archiving-stats_files/figure-html/aged-public-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Age of packages being archived.** Older packages are increasingly being archived but not at the same rate time passes.](cran-archiving-stats_files/figure-html/aged-public1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![**Time since previous releases of packages being archived.** Almost a constant rate except on a a specific moments.](cran-archiving-stats_files/figure-html/aged-public2-1.png){width=672}\n:::\n:::\n\n\n### Archived because depends on other packages\n\nWhen a package is going to be archived CRAN sends an email to the maintainer which package in trouble and all the packages maintainers that depend on it. \nThis often results in people stepping up and fixing the package.\nWhen this doesn't happen, packages will be archived together with their dependency.\n\n\n::: {.cell tbl-cap='**Dependencies impact** Most packages archived result in another package archived.'}\n::: {.cell-output-display}\n\n\n| Affected packages | Times |\n|:-----------------:|:-----:|\n|         1         |  437  |\n|         2         |  145  |\n|         3         |  81   |\n|         4         |  42   |\n|         5         |  33   |\n|         6         |  23   |\n|         7         |  12   |\n|         8         |   3   |\n|         9         |   2   |\n|        11         |   3   |\n|        12         |   2   |\n|        13         |   2   |\n|        17         |   6   |\n|        20         |   2   |\n|        22         |   2   |\n\n\n:::\n:::\n\n\n\nThe packages that affected more packages lead to 18 packages archived.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Archived packages due to a dependency often come back.** In absolute numbers (left) and in percentage (right). Many packages that are archived result in another package being archived, which are usually back to CRAN.](cran-archiving-stats_files/figure-html/depending-on2-1.png){width=672}\n:::\n:::\n\n\nThose packages that were archived were mostly back on CRAN.\n\n### Maintainers\n\n#### Failing email\n\nSometimes the problem is with maintainer's email.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![**Packages with not responsive maintainer address are archived later after the last version.** The line indicates the aproximation of these two variables.](cran-archiving-stats_files/figure-html/maintainers-emails-1.png){width=672}\n:::\n:::\n\n\nAs the time increase between being archived and the failing email, this seems to indicate that maintainers are now more careful with the email given.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}